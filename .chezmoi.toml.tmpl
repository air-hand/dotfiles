{{ $interactive := stdinIsATTY }}

{{/* skip apply .gitconfig on devcontainer */}}
{{ $git_name := "" }}
{{ $git_email := "" }}
{{ $git_signingkey := "" }}
{{- if $interactive }}
{{ $git_name = promptStringOnce . "git_name" "What is your name for git." }}
{{ $git_email = promptStringOnce . "git_email" "What is your email for git." }}
{{ $git_signingkey = promptStringOnce . "git_signingkey" "What is your gpg signingkey for git." }}
{{- end }}

{{/* skip aqua attestation if needed */}}
{{ $aqua_disable_github_artifact_attestation := false }}
{{- if $interactive }}
{{ $aqua_disable_github_artifact_attestation = promptBoolOnce . "aqua_disable_github_artifact_attestation" "Do you want to disable GitHub artifact attestation." }}
{{- end }}

{{/* skip aqua cosign if needed */}}
{{ $aqua_disable_cosign := false }}
{{- if $interactive }}
{{ $aqua_disable_cosign = promptBoolOnce . "aqua_disable_cosign" "Do you want to disable cosign." }}
{{- end }}

{{/* skip setup wsl2 docker if needed */}}
{{ $disable_setup_wsl2_docker := false }}
{{- if $interactive }}
{{ $disable_setup_wsl2_docker = promptBoolOnce . "disable_setup_wsl2_docker" "Do you want to disable WSL2 Docker setup." }}
{{- end }}

{{- if (env "MY_CHEZMOI_SOURCE") }}
sourceDir = "{{ env "MY_CHEZMOI_SOURCE" }}"
{{- end }}

[edit]
    command = "vim"
    apply = true

[data]
    git_name = {{ $git_name | quote }}
    git_email = {{ $git_email | quote }}
    git_signingkey = {{ $git_signingkey | quote }}
    aqua_disable_github_artifact_attestation = {{ $aqua_disable_github_artifact_attestation }}
    aqua_disable_cosign = {{ $aqua_disable_cosign }}
    disable_setup_wsl2_docker = {{ $disable_setup_wsl2_docker }}
    {{/* pass .chezmoi dictionary to template */}}
    {{ includeTemplate "host.toml.tmpl" .chezmoi }}
    {{ includeTemplate "proxy.toml.tmpl" .chezmoi }}
